(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,n){},128:function(e,t){},130:function(e,t){},140:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(64),s=n.n(c),i=(n(81),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,141)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))}),o=n(30),r=n(2),l=n(1);var u=function(){return Object(l.jsx)("div",{children:"this  a home route"})},j=n(42),m=n(6),d=n(33),p=n.n(d),b=(n(84),n(65)),f=n(20),h=n.n(f);var O=function(){var e=Object(r.f)(),t=Object(a.useState)(""),n=Object(m.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(""),o=Object(m.a)(i,2),u=o[0],d=o[1],f=Object(a.useState)(""),O=Object(m.a)(f,2),g=O[0],x=O[1],v=Object(a.useState)(""),_=Object(m.a)(v,2),N=_[0],w=_[1];Object(a.useEffect)((function(){var t=localStorage.getItem("authToken"),n=h.a.post("/auth/validateToken",{token:t},{header:{"Content-type":"application/json"}}).then((function(t){e("/video-chat")})).catch((function(t){console.log(t),e("/login")}));n.data}),[e]);var k=function(){var t=Object(j.a)(p.a.mark((function t(n){var a,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={header:{"Content-type":"application/json"}},t.prev=2,t.next=5,h.a.post("/auth/login",{email:c,password:u,username:g},a);case 5:s=t.sent,i=s.data,console.log("data",i),localStorage.setItem("authToken",i.token),e("/video-chat",{state:g}),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0.response.data.error),w(t.t0.response.data.error),setTimeout((function(){w("")}),5e3);case 17:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(j.a)(p.a.mark((function t(n){var a,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={header:{"Content-type":"application/json"}},t.prev=2,t.next=5,h.a.post("/auth/register",{username:g,password:u,email:c},a);case 5:s=t.sent,i=s.data,console.log("data",i),localStorage.setItem("authToken",i.token),e("/video-chat",{state:g}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),w(t.t0.response.data.error),setTimeout((function(){w("")}),5e3);case 16:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(l.jsxs)("div",{children:[Object(l.jsxs)(b.a,{children:[Object(l.jsx)("meta",{charset:"UTF-8"}),Object(l.jsx)("meta",{"http-equiv":"X-UA-Compatible",content:"IE=edge"}),Object(l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),Object(l.jsx)("title",{children:"Sign In & Sign Up Form"}),Object(l.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),Object(l.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap",rel:"stylesheet"}),Object(l.jsx)("script",{src:"https://kit.fontawesome.com/1788c719dd.js",crossorigin:"anonymous"})]}),Object(l.jsxs)("div",{className:"container",children:[Object(l.jsx)("div",{className:"container__forms",children:Object(l.jsxs)("div",{className:"form",children:[Object(l.jsxs)("form",{action:"",className:"form__sign-in",onSubmit:k,children:[Object(l.jsx)("h2",{className:"form__title",children:"Sign In"}),N&&Object(l.jsx)("span",{children:N}),Object(l.jsxs)("div",{className:"form__input-field",children:[Object(l.jsx)("i",{className:"fas fa-user"}),Object(l.jsx)("input",{type:"text",placeholder:"Username",required:!0,name:"username",value:g,onChange:function(e){x(e.target.value)}})]}),Object(l.jsxs)("div",{className:"form__input-field",children:[Object(l.jsx)("i",{className:"fas fa-lock"}),Object(l.jsx)("input",{type:"password",placeholder:"Password",required:!0,name:"password",value:u,onChange:function(e){d(e.target.value)}})]}),Object(l.jsx)("input",{className:"form__submit",type:"submit",value:"Login"}),Object(l.jsx)("p",{className:"form__social-text",children:"Or Sign in with social platforms"}),Object(l.jsxs)("div",{className:"form__social-media",children:[Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-facebook-f"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-twitter"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-google"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-linkedin-in"})})]})]}),Object(l.jsxs)("form",{onSubmit:y,className:"form__sign-up",children:[Object(l.jsx)("h2",{className:"form__title",children:"Sign Up"}),N&&Object(l.jsx)("span",{children:N}),Object(l.jsxs)("div",{className:"form__input-field",children:[Object(l.jsx)("i",{className:"fas fa-user"}),Object(l.jsx)("input",{type:"text",placeholder:"Username",required:!0,name:"username",value:g,onChange:function(e){x(e.target.value)}})]}),Object(l.jsxs)("div",{className:"form__input-field",children:[Object(l.jsx)("i",{className:"fas fa-envelope"}),Object(l.jsx)("input",{type:"text",placeholder:"Email",required:!0,name:"email",value:c,onChange:function(e){s(e.target.value)}})]}),Object(l.jsxs)("div",{className:"form__input-field",children:[Object(l.jsx)("i",{className:"fas fa-lock"}),Object(l.jsx)("input",{type:"password",placeholder:"Password",required:!0,name:"password",value:u,onChange:function(e){d(e.target.value)}})]}),Object(l.jsx)("input",{className:"form__submit",type:"submit",value:"Sign Up"}),Object(l.jsx)("p",{className:"form__social-text",children:"Or Sign up with social platforms"}),Object(l.jsxs)("div",{className:"form__social-media",children:[Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-facebook-f"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-twitter"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-google"})}),Object(l.jsx)("a",{href:"/",className:"form__social-icons",children:Object(l.jsx)("i",{className:"fab fa-linkedin-in"})})]})]})]})}),Object(l.jsxs)("div",{className:"container__panels",children:[Object(l.jsxs)("div",{className:"panel panel__left",children:[Object(l.jsxs)("div",{className:"panel__content",children:[Object(l.jsx)("h3",{className:"panel__title",children:"New here ?"}),Object(l.jsx)("p",{className:"panel__paragraph",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque adipisci tempore aliquid?"}),Object(l.jsx)("button",{className:"btn btn-transparent",id:"sign-up-btn",onClick:function(){document.querySelector(".container").classList.add("sign-up-mode")},children:"Sign Up"})]}),Object(l.jsx)("img",{className:"panel__image",src:"https://stories.freepiklabs.com/storage/11588/market-launch-amico-2628.png",alt:""})]}),Object(l.jsxs)("div",{className:"panel panel__right",children:[Object(l.jsxs)("div",{className:"panel__content",children:[Object(l.jsx)("h3",{className:"panel__title",children:"One of us ?"}),Object(l.jsx)("p",{className:"panel__paragraph",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque adipisci tempore aliquid?"}),Object(l.jsx)("button",{className:"btn btn-transparent",id:"sign-in-btn",onClick:function(){document.querySelector(".container").classList.remove("sign-up-mode")},children:"Sign In"})]}),Object(l.jsx)("img",{className:"panel__image",src:"https://www.pngkey.com/png/full/444-4444270_ia-press-play-website.png",alt:""})]})]})]})]})};var g=function(){return Object(l.jsx)("div",{children:"this is resetpassword route"})},x=n(76),v=Object(x.a)(" https://peer-wrtc-video.herokuapp.com/",{reconnect:!0,rejectUnauthorized:!1});var _,N=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],c=t[1],s=Object(r.f)(),i=Object(a.useRef)();return i.current=Object(r.e)().state,Object(a.useEffect)((function(){localStorage.getItem("authToken")||s("/login",{username:"plese login to continue"});var e=localStorage.getItem("authToken");h.a.post("/auth/validateToken",{token:e},{header:{"Content-type":"application/json"}}).then((function(t){var n=e.split(".")[1].replace("-","+").replace("_","/"),a=JSON.parse(window.atob(n));i.current=a.user,v.on("connect",(function(){console.log("you are connected with id ",v.id),console.log(i.current)}))})).catch((function(e){s("/login")}))})),v.on("connect_error",(function(e){})),Object(l.jsxs)("div",{children:[Object(l.jsx)("button",{type:"button",onClick:function(){alert("button clicked"),v.emit("create-room",(function(e){s("/room/".concat(e),{state:{joined:"true",username:i.current}})}))},children:"Create room"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault();v.emit("join-room",n,i.current,(function(e){console.log("joined room ",e,i.current),s("/room/".concat(e),{state:{joined:"true",username:i.current}})}))},children:[Object(l.jsx)("input",{type:"text",placeholder:"Rooom ID",value:n,onChange:function(e){c(e.target.value)}}),Object(l.jsx)("button",{type:"submit",children:"Join Room"})]}),Object(l.jsx)("button",{type:"button",name:"login",onClick:function(){localStorage.setItem("authToken",""),s("/login")},children:"Logout"})]})},w=n(39),k=n(71),y=(n(107),n(43)),S=n.n(y),I=n(72);var C=function(){var e=Object(r.f)(),t=Object(a.useState)(""),n=Object(m.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)([]),o=Object(m.a)(i,2),u=o[0],j=o[1],d=Object(r.g)().roomID,p=Object(a.useRef)(),b=Object(a.useRef)(),f=Object(r.e)().state,O=Object(a.useState)([]),g=Object(m.a)(O,2),x=g[0],N=g[1],y=Object(a.useRef)(),C=Object(a.useRef)(),D=Object(a.useRef)([]);I.a.video(_||(_=Object(k.a)(["\n    height: 40%;\n    width: 50%;\n"]))),Object(a.useEffect)((function(){p&&p.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})}))}),[]);var T={height:window.innerHeight/2,width:window.innerWidth/2};Object(a.useEffect)((function(){y.current=v,navigator.mediaDevices.getUserMedia({video:T,audio:!0}).then((function(e){C.current.srcObject=e,y.current.emit("join room"),y.current.on("all users",(function(t){console.log("all users is called ");var n=[];t.forEach((function(t){var a=function(e,t,n){var a=new S.a({initiator:!0,trickle:!1,stream:n});return a.on("signal",(function(n){y.current.emit("sending signal",{userToSignal:e,callerID:t,signal:n})})),a}(t,y.current.id,e);D.current.push({peerID:t,peer:a}),n.push(a)})),console.log("peersss",n),N(n)})),y.current.on("user joined",(function(t){console.log("user joined is called with apthlod ");var n=function(e,t,n){var a=new S.a({initiator:!1,trickle:!1,stream:n});return a.on("signal",(function(e){y.current.emit("returning signal",{signal:e,callerID:t})})),a.signal(e),a}(t.signal,t.callerID,e);D.current.push({peerID:t.callerID,peer:n}),N((function(e){return[].concat(Object(w.a)(e),[n])}))})),y.current.on("receiving returned signal",(function(e){D.current.find((function(t){return t.peerID===e.id})).peer.signal(e.signal)}))}))}),[]),Object(a.useEffect)((function(){var t=localStorage.getItem("authToken");h.a.post("/auth/validateToken",{token:t},{header:{"Content-type":"application/json"}}).then((function(n){var a=t.split(".")[1].replace("-","+").replace("_","/"),c=JSON.parse(window.atob(a));b.current=c.user,console.log(!f),f?q("Welcome ".concat(f.username," to the room "),""):(console.log(f),e("/video-chat"))})).catch((function(t){console.log(t),e("/login")}))}),[e,f]);var q=function(e,t){var n=t;n=""===t?"":t+":",j([].concat(Object(w.a)(u),[{message:e,person_id:n,time:Date.now(),classType:"other"}]))};return v.on("recieve-message",(function(e,t){q(e,t)})),v.on("joined",(function(e){var t=e.newUser;console.log("user joined ",t),q("".concat(t," joined the chat"),"")})),Object(l.jsxs)("div",{className:"container-room",children:[Object(l.jsxs)("div",{className:"video-card",children:[Object(l.jsx)("video",{muted:!0,ref:C,autoPlay:!0,playsInline:!0}),x.map((function(e,t){return Object(l.jsx)("video",{peer:e,playsInline:!0,autoPlay:!0},t)})),Object(l.jsx)("div",{className:"controls"})]}),Object(l.jsxs)("div",{className:"chat",children:[Object(l.jsx)("div",{className:"content",ref:p,children:u.map((function(e){return Object(l.jsxs)("p",{className:e.classType,children:[e.person_id,e.message]},e.time)}))}),Object(l.jsxs)("div",{className:"message",children:[Object(l.jsx)("input",{type:"text",name:"message",id:"input-field",value:c,onChange:function(e){s(e.target.value)}}),Object(l.jsx)("button",{id:"send",onClick:function(){j([].concat(Object(w.a)(u),[{message:c,person_id:b.current+":",time:Date.now(),classType:"me"}])),v.emit("send-message",c,d,b.current),s("")},children:"send"})]})]})]})};s.a.render(Object(l.jsx)(o.a,{children:Object(l.jsxs)(r.c,{children:[Object(l.jsx)(r.a,{path:"/",element:Object(l.jsx)(u,{})}),Object(l.jsx)(r.a,{path:"/login",element:Object(l.jsx)(O,{})}),Object(l.jsx)(r.a,{path:"/reset-password",element:Object(l.jsx)(g,{})}),Object(l.jsx)(r.a,{path:"/video-chat",element:Object(l.jsx)(N,{})}),Object(l.jsx)(r.a,{path:"/room/:roomID",element:Object(l.jsx)(C,{})})]})}),document.getElementById("root")),i()},81:function(e,t,n){},84:function(e,t,n){}},[[140,1,2]]]);
//# sourceMappingURL=main.b9fdf8b9.chunk.js.map